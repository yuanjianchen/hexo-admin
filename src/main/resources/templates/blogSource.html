<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>文章源文件管理</title>
    <link rel="stylesheet" th:include="component/head::head"/>
    <link href="/css/plugins/jsTree/style.min.css" rel="stylesheet">
    <style type="text/css">
        .text-center {
            text-align: unset;
        }

        .fileTree {
            border-right: 1px solid #f3f3f4;
        }

        #treeFile {
            overflow: auto;
            white-space: nowrap;
        }

        #treeFile::-webkit-scrollbar {
            height: 6px;
        }

        #treeFile::-webkit-scrollbar-thumb {
            background: grey;
        }
        .wrapper,.ibox,.ibox-content,.row,.fileTree{
            height: 100%;
            overflow: auto;
        }
    </style>
</head>
<body class="gray-bg">
<div class="wrapper wrapper-content animated fadeInRight">
    <div class="ibox float-e-margins">
        <div class="ibox-content text-center p-md">
            <div class="row">
                <div class="col-sm-3 fileTree">
                    <div id="treeFile" th:value="${configId}" class="test"></div>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:include="component/head::script"/>
<script src="/js/plugins/jsTree/jstree.min.js"></script>
<script type="text/javascript">
    $(function () {
        const blogId = $('#treeFile').attr('value')
        $.get("/blog/" + blogId + "/source/post", function (res) {
            if (res.success) {
                $('#treeFile').jstree({
                    'core': {
                        'data': res.data
                    }
                });
            }
        })
        $('#treeFile').on("select_node.jstree", function (e, data) {
            $('#treeFile').jstree('toggle_node', data.selected)
            console.log(data)
            if(!data.node.children.length > 0){
               let path =  $('#treeFile').jstree('get_path',data.selected, '/')
                console.log(path)
                return
            }
            if (data.node.state.opened) {
                $('#' + data.node.a_attr.id).find('i').removeClass('fa-folder-o')
                $('#' + data.node.a_attr.id).find('i').addClass('fa-folder-open-o')
            } else {
                $('#' + data.node.a_attr.id).find('i').removeClass('fa-folder-open-o')
                $('#' + data.node.a_attr.id).find('i').addClass('fa-folder-o')
            }
        });
    })
</script>
</body>
</html>